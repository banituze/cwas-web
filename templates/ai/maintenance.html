{% extends "base.html" %}
{% block title %}Predictive Maintenance{% endblock %}
{% block page_title %}Predictive Maintenance{% endblock %}
{% block content %}
<div class="card mb-6">
    <h3 class="mb-4">Maintenance Risk Assessment</h3>
    <div class="table-container"><table class="table"><thead><tr><th>Source</th><th>Health</th><th>Days Since Maintenance</th><th>Risk Score</th><th>Risk Level</th><th>Recommendation</th></tr></thead><tbody>
    {% for p in predictions %}<tr><td><strong>{{ p.source.name }}</strong><br><span class="text-muted">{{ p.source.district }}</span></td><td><span style="color:{% if p.source.health_score >= 80 %}var(--success){% elif p.source.health_score >= 50 %}var(--warning){% else %}var(--error){% endif %}">{{ p.source.health_score }}%</span></td><td>{{ p.days_since_maintenance }}</td><td><div style="width:60px;height:8px;background:var(--border-color);border-radius:4px"><div style="height:100%;border-radius:4px;width:{{ p.risk_score }}%;background:{% if p.risk_level == 'critical' %}var(--error){% elif p.risk_level == 'high' %}#ff6600{% elif p.risk_level == 'medium' %}var(--warning){% else %}var(--success){% endif %}"></div></div>{{ p.risk_score }}%</td><td><span class="badge badge-{% if p.risk_level == 'critical' %}denied{% elif p.risk_level == 'high' %}pending{% elif p.risk_level == 'medium' %}maintenance{% else %}active{% endif %}">{{ p.risk_level|upper }}</span></td><td style="font-size:13px">{{ p.recommended_action }}</td></tr>{% endfor %}
    </tbody></table></div>
</div>
<div class="card">
    <h3 class="mb-4">Recent Maintenance Records</h3>
    {% if recent_maintenance %}<div class="table-container"><table class="table"><thead><tr><th>Source</th><th>Type</th><th>Date</th><th>Status</th><th>Cost</th></tr></thead><tbody>{% for m in recent_maintenance %}<tr><td>{{ m.source_name }}</td><td>{{ m.maintenance_type }}</td><td>{{ m.scheduled_date }}</td><td><span class="badge badge-{{ m.status }}">{{ m.status }}</span></td><td>{{ "{:,.0f}".format(m.cost) }} Ar</td></tr>{% endfor %}</tbody></table></div>{% else %}<p class="text-muted">No maintenance records</p>{% endif %}
</div>
{% endblock %}
