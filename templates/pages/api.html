<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Documentation - CWAS</title>
    <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;500;600;700&family=JetBrains+Mono&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root{--primary:#00ff00;--bg:#0a0a0a;--card:#111;--border:#222;--text:#fff;--muted:#888}
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:'Lexend',sans-serif;background:var(--bg);color:var(--text);line-height:1.6}
        a{color:var(--primary);text-decoration:none}
        .navbar{padding:20px 40px;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid var(--border)}
        .logo{display:flex;align-items:center;gap:12px}
        .logo-icon{width:40px;height:40px;background:var(--primary);border-radius:10px;display:flex;align-items:center;justify-content:center;color:var(--bg)}
        .logo-text{font-size:24px;font-weight:700;color:var(--primary)}
        .btn{padding:10px 20px;background:var(--primary);color:var(--bg);border-radius:8px;font-weight:600}
        .container{max-width:1000px;margin:0 auto;padding:60px 20px}
        h1{font-size:42px;margin-bottom:16px}
        .lead{color:var(--muted);margin-bottom:40px}
        h2{font-size:24px;margin:40px 0 16px;color:var(--primary)}
        h3{font-size:18px;margin:24px 0 12px}
        p{color:var(--muted);margin-bottom:16px}
        .endpoint{background:var(--card);border:1px solid var(--border);border-radius:12px;margin-bottom:24px;overflow:hidden}
        .endpoint-header{padding:16px 20px;border-bottom:1px solid var(--border);display:flex;align-items:center;gap:12px}
        .method{padding:4px 12px;border-radius:4px;font-size:12px;font-weight:600}
        .method.get{background:rgba(0,170,255,0.2);color:#0af}
        .method.post{background:rgba(0,255,0,0.2);color:#0f0}
        .endpoint-path{font-family:'JetBrains Mono',monospace;font-size:14px}
        .endpoint-body{padding:20px}
        .endpoint-desc{margin-bottom:16px}
        code{background:var(--bg);padding:2px 8px;border-radius:4px;font-family:'JetBrains Mono',monospace;font-size:13px}
        pre{background:var(--bg);padding:16px;border-radius:8px;overflow-x:auto;font-family:'JetBrains Mono',monospace;font-size:13px}
    </style>
</head>
<body>
    <nav class="navbar">
        <a href="/" class="logo"><div class="logo-icon"><i class="fas fa-droplet"></i></div><span class="logo-text">CWAS</span></a>
        <a href="{{ url_for('login') }}" class="btn">Sign In</a>
    </nav>
    <div class="container">
        <h1>API Documentation</h1>
        <p class="lead">Integrate CWAS with your applications using our REST API.</p>
        
        <h2>Authentication</h2>
        <p>All API requests require authentication via session cookies. Log in through the web interface first.</p>

        <h2>Endpoints</h2>

        <div class="endpoint">
            <div class="endpoint-header"><span class="method get">GET</span><span class="endpoint-path">/api/slots/{date}/{source_id}</span></div>
            <div class="endpoint-body">
                <p class="endpoint-desc">Get available time slots for a specific date and water source.</p>
                <h4>Parameters</h4>
                <p><code>date</code> - Date in YYYY-MM-DD format<br><code>source_id</code> - Water source ID</p>
                <h4>Response</h4>
                <pre>[{"id": 1, "start_time": "06:00", "end_time": "06:30", "max_capacity": 10, "booked_count": 3}]</pre>
            </div>
        </div>

        <div class="endpoint">
            <div class="endpoint-header"><span class="method get">GET</span><span class="endpoint-path">/api/districts/{region}</span></div>
            <div class="endpoint-body">
                <p class="endpoint-desc">Get list of districts for a region.</p>
                <h4>Response</h4>
                <pre>["Antananarivo", "Ankazobe", "Anjozorobe"]</pre>
            </div>
        </div>

        <div class="endpoint">
            <div class="endpoint-header"><span class="method post">POST</span><span class="endpoint-path">/api/chat</span></div>
            <div class="endpoint-body">
                <p class="endpoint-desc">Send a message to the AI chatbot.</p>
                <h4>Request Body</h4>
                <pre>{"message": "What is my balance?"}</pre>
                <h4>Response</h4>
                <pre>{"response": "Your current balance is 50,000 Ar.", "intent": "balance"}</pre>
            </div>
        </div>

        <div class="endpoint">
            <div class="endpoint-header"><span class="method get">GET</span><span class="endpoint-path">/api/reports/bookings</span></div>
            <div class="endpoint-body">
                <p class="endpoint-desc">Get booking statistics for reporting.</p>
                <h4>Query Parameters</h4>
                <p><code>period</code> - Number of days (default: 30)</p>
            </div>
        </div>

        <h2>Rate Limits</h2>
        <p>API requests are limited to 100 requests per minute per user.</p>
    </div>
</body>
</html>
